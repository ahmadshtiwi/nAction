<div class="row">
    <div class="col-md-4 col-12 d-flex align-items-center">
        <label class="text-black required-label me-2" for="fromCity">{{'Resource Name'}}</label>
        <ng-select name="maxDeliveryDate" [placeholder]="'CHOOSE'" required class="bg-dark-primary border text-primary flex-grow-1"
            [(ngModel)]="ProductivityPagination.employeeId" [items]="users"
            (ngModelChange)="getDashboardData()" [bindLabel]="'fullName'" [bindValue]="'id'"
            [multiple]="false">
        </ng-select>
    </div>
    
    @if (ProductivityPagination.employeeId) {
        <div class="col-md-4 col-12 d-flex align-items-center">
            <label class="text-black required-label me-2" for="fromDate">{{'From Date'}}</label>
            <input type="date" class="form-control flex-grow-1 w-75" name="fromDate" [(ngModel)]="ProductivityPagination.fromDate"
                (ngModelChange)="getDashboardData() ; ProductivityPagination.pageNumber = 1; efficiencyPagination.pageNumber = 1; resourceAllocationPagination.pageNumber = 1; ">
        </div>
        <div class="col-md-4 col-12 d-flex align-items-center">
            <label class="text-black required-label me-2" for="toDate">{{'To Date'}}</label>
            <input type="date" class="form-control flex-grow-1 w-75" name="toDate" [(ngModel)]="ProductivityPagination.toDate"
                (ngModelChange)="getDashboardData()">
        </div>    

    <div class="col-md-4 mt-3">
        <div class="card shadow-sm">
            <div class="card-body row m-0 p-0">
                <div class="col-4 row p-0 m-0">
                    <!-- Left: Title -->
                    <div class="col-12 p-0"><p class="card-title text-center">{{ 'Productivity' }}</p></div>
                    <div class="col-12 p-0"><p class="card-title text-center">{{ productivityCard.overallProductivity }}%</p></div>
                </div>
                    <div class="col-8 p-0">

                        <!-- Right: Summary -->
                        <div class="card-summary row p-0 m-0">
                            <div class="col-8 text-center"><strong>{{ 'Days' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productivityCard.totalDays}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Tasks' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productivityCard.totalDistinctTasks}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Official Hours' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productivityCard.officialHours}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Actual Hours' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productivityCard.actualHours}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Daily average' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productivityCard.dailyAverage}}</div>
                        </div>
                    </div>
            </div>
        </div>
    </div>

    <div class="col-md-4 mt-3">
        <div class="card shadow-sm">
            <div class="card-body row m-0 p-0">
                <div class="col-4 row p-0 m-0">
                    <!-- Left: Title -->
                    <div class="col-12 p-0"><p class="card-title text-center">{{ 'Efficiency' }}</p></div>
                    <div class="col-12 p-0"><p class="card-title text-center">{{ efficiencyCard.overallEfficiency }}%</p></div>
                </div>
                    <div class="col-8 p-0">

                        <!-- Right: Summary -->
                        <div class="card-summary row p-0 m-0">
                            <div class="col-8 text-center"><strong>{{ 'Tasks' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{efficiencyCard.totalTasks}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Est Hours' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{efficiencyCard.totalExpectedDuration}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Actual Hours' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{efficiencyCard.totalActualDuration}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Deadline score' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{efficiencyCard.deadlineScore}}</div>
                        </div>
                    </div>
            </div>
        </div>
    </div>

    <div class="col-md-4 mt-3">
        <div class="card shadow-sm">
            <div class="card-body row m-0 p-0">
                <div class="col-4 row p-0 m-0">
                    <!-- Left: Title -->
                    <div class="col-12 p-0"><p class="card-title text-center">{{ 'Projects' }}</p></div>
                    <div class="col-12 p-0"><p class="card-title text-center">{{ productCard.projectsCount }}</p></div>
                </div>
                    <div class="col-8 p-0">

                        <!-- Right: Summary -->
                        <div class="card-summary row p-0 m-0">
                            
                            <div class="col-8 text-center"><strong>{{ 'allocated time' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productCard.totalAllocatedTime}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Total Tasks' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productCard.totalTasks}}</div>
                            
                            <div class="col-8 text-center"><strong>{{ 'Total Cost' }}:</strong></div>
                            <div class="col-4 text-center p-0">{{productCard.totalCost}}</div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
    }

    @if(ProductivityData){
    <div class="col-12 mt-2">
        <app-table [tableData]="ProductivityData" [collectionSize]="ProductivityPagination.totalCount" [page]="ProductivityPagination.pageNumber" [pageSize]="ProductivityPagination.pageSize"
            [tableHeaderTitle]="ProductivityHeaderTitle" [removeAddButton]="false" [viewUnsubmittedRequestButton]="false"
            [tableHeaderButton]="'Create new task'" [tableHeaders]="tableHeaders" [displayColumns]="productivityColumns"
            [viewLog]="false" [isViewOnly]="false" [removeActions]="true" [viewUnsubmittedRequestButton]="false"
            [removeFilter]="true"
            [unsubmittedComponentRouting]="'/pages/assignment-managment/unsubmitted-assignment-requests'"
            (pageChangeEvent)="performanceNextPage($event)" [removeAddButton]="true"
            (openFilterModalEvent)="openModal(content)">
        </app-table>
    </div>

    <hr class="my-3">

    <div class="col-12 p-0">
        <app-table [tableData]="efficiencyData" [collectionSize]="efficiencyPagination.totalCount" [page]="efficiencyPagination.pageNumber" [pageSize]="efficiencyPagination.pageSize"
            [tableHeaderTitle]="efficiencyHeaderTitle" [removeAddButton]="false" [viewUnsubmittedRequestButton]="false"
            [tableHeaderButton]="'Create new task'" [tableHeaders]="tableHeaders2" [displayColumns]="efficiencyColumns"
            [viewLog]="false" [isViewOnly]="false" [removeActions]="true" [viewUnsubmittedRequestButton]="false"
            [unsubmittedComponentRouting]="'/pages/assignment-managment/unsubmitted-assignment-requests'"
            [removeFilter]="true" (pageChangeEvent)="efficiencyNextPage($event)" [removeAddButton]="true"
            (openFilterModalEvent)="openModal(content)">
        </app-table>
    </div>

    <hr class="my-3">

    <div class="col-12 p-0">
        <app-table [tableData]="resourceAllocation" [collectionSize]="resourceAllocationPagination.totalCount" [page]="resourceAllocationPagination.pageNumber" [pageSize]="resourceAllocationPagination.pageSize"
            [tableHeaderTitle]="allocationHeaderTitle" [removeAddButton]="false" [viewUnsubmittedRequestButton]="false"
            [tableHeaderButton]="'Create new task'" [tableHeaders]="tableHeaders3" [displayColumns]="resourceAllocationColumns"
            [viewLog]="false" [isViewOnly]="false" [removeActions]="true" [viewUnsubmittedRequestButton]="false"
            [unsubmittedComponentRouting]="'/pages/assignment-managment/unsubmitted-assignment-requests'"
            [removeFilter]="true" (pageChangeEvent)="resourceAllocationNextPage($event)" [removeAddButton]="true"
            (openFilterModalEvent)="openModal(content)">
        </app-table>
    </div>
    }@else {
    <div class="col-12 p-3 text-center">
        no data found
    </div>
    }


</div>