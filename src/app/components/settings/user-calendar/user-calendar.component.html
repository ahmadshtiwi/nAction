<div class="conainer p-2">
    <div class="row">
        @if (userName) {
        <h3>
            {{userName}}
        </h3>
        }
        <div class="week-schedule col-10">
            @if(!showDate){

                <form #backlogDay="ngForm" (ngSubmit)="submitBackLogDay()" class="mt-0">
                    <!-- Section 1: Backlog Period -->
                    <div class="card p-4 mb-4 w-100">
                        <h4 class="fw-bold mb-3 text-start">Backlog Period</h4>
                        <div class="row">
                            <div class="col-md-6 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Backlog Days:</label>
                                <input type="number" class="form-control" name="backlogDays"
                                    [(ngModel)]="parameters.parameters.Backlog_Days" placeholder="Enter backlog days">
                            </div>
                        </div>
                    </div>
                
                    <!-- Section 2: Task Rejection -->
                    <div class="card p-4 mb-4 w-100">
                        <h4 class="fw-bold mb-3 text-start">Task Rejection</h4>
                        <div class="row">
                            <div class="col-md-6 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Reject Prefix:</label>
                                <input type="text" class="form-control" name="Reject_Prefix"
                                    [(ngModel)]="parameters.parameters.Reject_Prefix" placeholder="Enter reject prefix">
                            </div>
                        </div>
                    </div>
                
                    <!-- Section 3: Inactive Automated Task -->
                    <div class="card p-4 mb-4 w-100">
                        <h4 class="fw-bold mb-3 text-start">Inactive Automated Task</h4>
                        <div class="row g-3">
                            <div class="col-md-4 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Inactive Task Project:</label>
                                <ng-select name="InactiveTaskProject" [placeholder]="'CHOOSE'"
                                    class="form-control w-100" [(ngModel)]="selectedProjectId"
                                    [items]="projects" [bindLabel]="'name'" [bindValue]="'id'" [multiple]="false">
                                    <ng-option [value]="null" class="text-muted">None</ng-option> 
                                </ng-select>
                            </div>
                            
                
                            <div class="col-md-4 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Task Title:</label>
                                <input type="text" class="form-control" name="InactiveTaskTitle"
                                    [(ngModel)]="parameters.parameters.InactiveTaskTitle" placeholder="Enter task title">
                            </div>
                
                            <div class="col-md-4 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Inactive resource name wildcard:</label>
                                <input type="text" class="form-control" name="InactiveTaskResource"
                                    [(ngModel)]="parameters.parameters.InactiveTaskResource" placeholder="Enter resource name">
                            </div>
                        </div>
                
                        <!-- Row 2 (Includes Task Duration as Two Separate Inputs) -->
                        <div class="row g-3 mt-3">
                            <div class="col-md-6 d-flex align-items-center gap-2">
                                <label class="form-label mb-0">Task Description:</label>
                                <input type="text" class="form-control" name="InactiveTaskDesc"
                                    [(ngModel)]="parameters.parameters.InactiveTaskDesc" placeholder="Enter task description">
                            </div>
                
                            <div class="col-12 w-auto d-flex align-items-center gap-2">
                                <label class="required-label my-2" for="duration" style="font-size: 16px; font-weight: solid;">Duration</label>
                                <div class="d-flex align-items-center">
                                    <input name="hours" appRestrictNonNumeric [(ngModel)]="parameters.parameters.TaskDurationHours"
                                        placeholder="HH" (input)="checkHours($event)"
                                        class="border text-start text-black p-2" type="number" min="0" max="23" style="width: 60px;">
                                    <h2 class="text-white mx-1">:</h2>
                                    <input name="minutes" appRestrictNonNumeric [(ngModel)]="parameters.parameters.TaskDurationMinutes"
                                        placeholder="MM" (input)="checkMinutes($event)"
                                        class="border text-start text-black p-2" type="number" min="0" max="59" style="width: 60px;">
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <!-- Submit Button -->
                    <div class="text-start mt-4">
                        <button type="submit" class="btn btn-warning mt-3">Submit</button>
                    </div>
                
                </form>
                
                
                
                
                
                
                


            <hr>
            <br>
            
            <div class="d-flex justify-content-between" style="width: 60%;">
                <h5 class=""><strong>Calendar</strong></h5>
                <button type="button" class="btn btn-warning mt-3 " routerLink="/pages/user-calendar-desc"><i
                        class="bi-plus"></i> Add Description</button>
            </div>


            }
            <form #scheduleForm="ngForm" (ngSubmit)="submitForm()">
                @if (showDate) {

                <input type="date" class="form-control w-25" name="date" [(ngModel)]="startDate"
                    (ngModelChange)="getUserWeek($event)">
                }
                <table class="table">
                    <thead>
                        <tr>
                            @if (showDate) {
                            <th>Date</th>
                            }
                            <th>Day</th>
                            <th>Working Hours</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (day of weekSchedule; track $index) {
                        <tr>
                            @if (day.date) {
                            <td>
                                {{day.date | date : 'dd/MM/yyyy' }}
                            </td>
                            }
                            <td>{{ day.dayName }}</td>
                            <td>
                                <ng-select [placeholder]="'Select Working Hours'" [(ngModel)]="day.requiredWorkingHours"
                                    [name]="'workingHours' + day.id" [items]="availableHours" bindLabel="label"
                                    bindValue="value" [clearable]="false" required>
                                </ng-select>
                            </td>
                            <td>
                                <ng-select [placeholder]="'CHOOSE'" required [name]="'id' + $index"
                                    [(ngModel)]="day.calendarDescriptionLookupId" [items]="descriptions"
                                    bindLabel="description" bindValue="id" [multiple]="false" [clearable]="true"
                                    [searchable]="true">
                                </ng-select>

                            </td>

                        </tr>
                        }
                    </tbody>
                </table>
                <button type="submit" class="btn btn-warning mt-3">Submit Changes</button>
            </form>

            
        </div>
    </div>

</div>